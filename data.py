#-------------------------------------------------------------------------------
# Name:        Psniffer.py
#
# Author:      Gardenia22
#
# Created:     10/21/2014
# Copyright:   (c) Gardenia22 2014
#
#-------------------------------------------------------------------------------

## -*- coding: utf-8 -*-
## some Protocol Data used in Psniffer

## List Headers
columns = ["No.", "Time", "Source", "Destination","Length","Protocol"]

## Filter Options
filters = [
	("No ARP","not arp"),
	("IPX only","ipx"),
	("IP only","ip"),
	("TCP only","tcp"),
	("UDP only","udp"),
	("No ARP and no DNS","not arp and port not 53"),
	("HTTP TCP port (80)","tcp port http"),
	("TCP or UDP port 80 (HTTP)","port 80"),
]

##Ethernet Protocol Types
etherType = {'0x8204': 'QNX Qnet', '0x8902': 'IEEE 802.1ag Connectivity Fault Management (CFM) Protocol / ITU-T Recommendation Y.1731 (OAM)', '0x9100': 'Q-in-Q', '0xcafe': 'Veritas Low Latency Transport (LLT)[7] for Veritas Cluster Server', '0x8906': 'Fibre Channel over Ethernet (FCoE)', '0x9000': 'Ethernet Configuration Testing Protocol[6]', '0x22f0': 'Audio Video Transport Protocol as defined in IEEE Std 1722-2011', '0x8137': 'IPX', '0x88e3': 'Media Redundancy Protocol (IEC62439-2)', '0x22f3': 'IETF TRILL Protocol', '0x889a': 'HyperSCSI (SCSI over Ethernet)', '0x8035': 'Reverse Address Resolution Protocol', '0x8138': 'IPX', '0x88a8': 'Provider Bridging (IEEE 802.1ad) & Shortest Path Bridging IEEE 802.1aq[5]', '0x88a4': 'EtherCAT Protocol', '0x8870': 'Jumbo Frames[2]', '0x88a2': 'ATA over Ethernet', '0x86dd': 'Internet Protocol Version 6 (IPv6)', '0x8819': 'CobraNet', '0x809b': 'AppleTalk (Ethertalk)', '0x8914': 'FCoE Initialization Protocol', '0x8915': 'RDMA over Converged Ethernet (RoCE)', '0x892f': 'High-availability Seamless Redundancy (HSR)', '0x0806': 'Address Resolution Protocol (ARP)', '0x88cd': 'SERCOS III', '0x88cc': 'Link Layer Discovery Protocol (LLDP)', '0x0800': 'Internet Protocol version 4 (IPv4)', '0x8892': 'PROFINET Protocol', '0x0842': 'Wake-on-LAN[3]', '0x6003': 'DECnet Phase IV', '0x888e': 'EAP over LAN (IEEE 802.1X)', '0x88e5': 'MAC security (IEEE 802.1AE)', '0x80f3': 'AppleTalk Address Resolution Protocol (AARP)', '0x88f7': 'Precision Time Protocol (PTP) over Ethernet (IEEE 1588)', '0x8100': 'VLAN-tagged frame (IEEE 802.1Q) & Shortest Path Bridging IEEE 802.1aq[4]', '0x88e1': 'HomePlug AV MME[citation needed]', '0x8847': 'MPLS unicast', '0x8864': 'PPPoE Session Stage', '0x8848': 'MPLS multicast', '0x8863': 'PPPoE Discovery Stage', '0x8808': 'Ethernet flow control', '0x8809': 'Slow Protocols (IEEE 802.3)', '0x887b': 'HomePlug 1.0 MME', '0x88ab': 'Ethernet Powerlink[citation needed]'}

##IPv4 Protocol Types
ipv4Type = {'0x3e': 'CFTP', '0x3d': 'Any host internal protocol', '0x3f': 'Any local network', '0x3a': 'ICMP for IPv6(IPv6-ICMP)', '0x3c': 'Destination Options for IPv6(IPv6-Opts)', '0x3b': 'No Next Header for IPv6(IPv6-NoNxt)', '0x28': 'IL Transport Protocol(IL)', '0x29': 'IPv6 Encapsulation(IPv6)', '0x22': 'Third Party Connect Protocol(3PC)', '0x23': 'Inter-Domain Policy Routing Protocol(IDPR)', '0x20': 'MERIT Internodal Protocol(MERIT-INP)', '0x21': 'Datagram Congestion Control Protocol(DCCP)', '0x26': 'IDPR Control Message Transport Protocol(IDPR-CMTP)', '0x27': 'TP++ Transport Protocol(TP++)', '0x24': 'Xpress Transport Protocol(XTP)', '0x25': 'Datagram Delivery Protocol(DDP)', '0x35': 'SwIPe(SWIPE)', '0x34': 'Integrated Net Layer Security Protocol(I-NLSP)', '0x37': 'IP Mobility (Min Encap)(MOBILE)', '0x36': 'NBMA Address Resolution Protocol(NARP)', '0x31': 'BNA', '0x30': 'Mobile Host Routing Protocol(MHRP)', '0x33': 'Authentication Header(AH)', '0x32': 'Encapsulating Security Payload(ESP)', '0x39': 'Simple Key-Management for Internet Protocol(SKIP)', '0x38': 'Transport Layer Security Protocol (using Kryptonet key management)(TLSP)', '0x88': 'Lightweight User Datagram Protocol(UDPLite)', '0x89': 'Multiprotocol Label Switching Encapsulated in IP(MPLS-in-IP)', '0x2b': 'Routing Header for IPv6(IPv6-Route)', '0x2c': 'Fragment Header for IPv6(IPv6-Frag)', '0x2a': 'Source Demand Routing Protocol(SDRP)', '0x2f': 'Generic Routing Encapsulation(GRE)', '0x2d': 'Inter-Domain Routing Protocol(IDRP)', '0x2e': 'Resource Reservation Protocol(RSVP)', '0x5c': 'Multicast Transport Protocol(MTP)', '0x5b': 'Locus Address Resolution Protocol(LARP)', '0x5a': 'Sprite RPC Protocol(Sprite-RPC)', '0x5f': 'Mobile Internetworking Control Protocol(MICP)', '0x5e': 'IP-within-IP Encapsulation Protocol(IPIP)', '0x5d': 'AX.25', '0x40': 'SATNET and Backroom EXPAK(SAT-EXPAK)', '0x41': 'Kryptolan(KRYPTOLAN)', '0x42': 'MIT Remote Virtual Disk Protocol(RVD)', '0x43': 'Internet Pluribus Packet Core(IPPC)', '0x44': 'Any distributed file system', '0x45': 'SATNET Monitoring(SAT-MON)', '0x46': 'VISA Protocol(VISA)', '0x47': 'Internet Packet Core Utility(IPCU)', '0x48': 'Computer Protocol Network Executive(CPNX)', '0x49': 'Computer Protocol Heart Beat(CPHB)', '0x4a': 'Wang Span Network(WSN)', '0x4b': 'Packet Video Protocol(PVP)', '0x4c': 'Backroom SATNET Monitoring(BR-SAT-MON)', '0x4d': 'SUN ND PROTOCOL-Temporary(SUN-ND)', '0x4e': 'WIDEBAND Monitoring(WB-MON)', '0x4f': 'WIDEBAND EXPAK(WB-EXPAK)', '0x53': 'VINES', '0x52': 'Secure Versatile Message Transaction Protocol(SECURE-VMTP)', '0x51': 'Versatile Message Transaction Protocol(VMTP)', '0x50': 'International Organization for Standardization Internet Protocol(ISO-IP)', '0x57': 'TCF', '0x56': 'Dissimilar Gateway Protocol(DGP)', '0x55': 'NSFNET-IGP', '0x54': 'Internet Protocol Traffic Manager(IPTM)', '0x59': 'Open Shortest Path First(OSPF)', '0x58': 'EIGRP', '0x7a': 'Simple Multicast Protocol(SM)', '0x7c': 'Intermediate System to Intermediate System (IS-IS) Protocol over IPv4(IS-IS over IPv4)', '0x7b': 'Performance Transparency Protocol(PTP)', '0x7e': 'Combat Radio Transport Protocol(CRTP)', '0x7d': 'Flexible Intra-AS Routing Environment(FIRE)', '0x7f': 'Combat Radio User Datagram(CRUDP)', '0x68': "IBM's ARIS (Aggregate Route IP Switching) Protocol(ARIS)", '0x69': 'SCPS (Space Communications Protocol Standards)(SCPS)', '0x66': 'PNNI over IP(PNNI)', '0x67': 'Protocol Independent Multicast(PIM)', '0x64': 'GMTP', '0x65': 'Ipsilon Flow Management Protocol(IFMP)', '0x62': 'Encapsulation Header(ENCAP)', '0x63': 'Any private encryption scheme', '0x60': 'Semaphore Communications Sec. Pro(SCC-SP)', '0x61': 'Ethernet-within-IP Encapsulation(ETHERIP)', '0x6f': 'IPX in IP(IPX-in-IP)', '0x6d': 'Sitara Networks Protocol(SNP)', '0x6e': 'Compaq Peer Protocol(Compaq-Peer)', '0x6b': 'Active Networks(A/N)', '0x6c': 'IP Payload Compression Protocol(IPComp)', '0x6a': 'QNX', '0x79': 'Simple Message Protocol(SMP)', '0x78': 'Universal Transport Interface Protocol(UTI)', '0x71': 'PGM Reliable Transport Protocol(PGM)', '0x70': 'Virtual Router Redundancy Protocol, Common Address Redundancy Protocol (not IANA assigned)(VRRP)', '0x73': 'Layer Two Tunneling Protocol Version 3(L2TP)', '0x72': 'Any 0-hop protocol', '0x75': 'Interactive Agent Transfer Protocol(IATP)', '0x74': 'D-II Data Exchange (DDX)(DDX)', '0x77': 'SpectraLink Radio Protocol(SRP)', '0x76': 'Schedule Transfer Protocol(STP)', '0x8b': 'Host Identity Protocol(HIP)', '0x8c': 'Site Multihoming by IPv6 Intermediation(Shim6)', '0x08': 'Exterior Gateway Protocol(EGP)', '0x09': 'Interior Gateway Protocol (any private interior gateway (used by Cisco for their IGRP))(IGP)', '0x04': 'IP-Within-IP (encapsulation)(IP-in-IP)', '0x05': 'Internet Stream Protocol(ST)', '0x06': 'Transmission Control Protocol(TCP)', '0x07': 'Core-based trees(CBT)', '0x00': 'IPv6 Hop-by-Hop Option(HOPOPT)', '0x01': 'Internet Control Message Protocol(ICMP)', '0x02': 'Internet Group Management Protocol(IGMP)', '0x03': 'Gateway-to-Gateway Protocol(GGP)', '0x84': 'Stream Control Transmission Protocol(SCTP)', '0x85': 'Fibre Channel(FC)', '0x86': 'Reservation Protocol (RSVP) End-to-End Ignore(RSVP-E2E-IGNORE)', '0x87': 'Mobility Extension Header for IPv6(Mobility Header)', '0x80': 'Service-Specific Connection-Oriented Protocol in a Multilink and Connectionless Environment(SSCOPMCE)', '0x81': '(IPLT)', '0x82': 'Secure Packet Shield(SPS)', '0x83': 'Private IP Encapsulation within IP(PIPE)', '0x1f': 'MFE Network Services Protocol(MFE-NSP)', '0x1e': 'Bulk Data Transfer Protocol(NETBLT)', '0x1d': 'ISO Transport Protocol Class 4(ISO-TP4)', '0x1c': 'Internet Reliable Transaction Protocol(IRTP)', '0x1b': 'Reliable Datagram Protocol(RDP)', '0x1a': 'Leaf-2(LEAF-2)', '0x8d': 'Wrapped Encapsulating Security Payload(WESP)', '0x8e': 'Robust Header Compression(ROHC)', '0x8a': 'MANET Protocols(manet)', '0x19': 'Leaf-1(LEAF-1)', '0x18': 'Trunk-2(TRUNK-2)', '0x17': 'Trunk-1(TRUNK-1)', '0x16': 'XEROX NS IDP(XNS-IDP)', '0x15': 'Packet Radio Measurement(PRM)', '0x14': 'Host Monitoring Protocol(HMP)', '0x13': 'DCN Measurement Subsystems(DCN-MEAS)', '0x12': 'Multiplexing(MUX)', '0x11': 'User Datagram Protocol(UDP)', '0x10': 'Chaos(CHAOS)', '0x0d': 'ARGUS', '0x0e': 'EMCON', '0x0f': 'Cross Net Debugger(XNET)', '0x0a': 'BBN RCC Monitoring(BBN-RCC-MON)', '0x0b': 'Network Voice Protocol(NVP-II)', '0x0c': 'Xerox PUP(PUP)'}

##Protocol Abbreviations
abbr = {'Address Resolution Protocol (ARP)':'ARP','Datagram Delivery Protocol(DDP)': 'DDP', 'Chaos(CHAOS)': 'CHAOS', 'Multiplexing(MUX)': 'MUX', 'WIDEBAND EXPAK(WB-EXPAK)': 'WB-EXPAK', 'Gateway-to-Gateway Protocol(GGP)': 'GGP', 'SpectraLink Radio Protocol(SRP)': 'SRP', 'Multicast Transport Protocol(MTP)': 'MTP', 'Resource Reservation Protocol(RSVP)': 'RSVP', 'DCN Measurement Subsystems(DCN-MEAS)': 'DCN-MEAS', 'Xerox PUP(PUP)': 'PUP', 'Computer Protocol Network Executive(CPNX)': 'CPNX', 'Semaphore Communications Sec. Pro(SCC-SP)': 'SCC-SP', 'Virtual Router Redundancy Protocol, Common Address Redundancy Protocol (not IANA assigned)(VRRP)': 'VRRP', '(IPLT)': 'IPLT', 'Internet Control Message Protocol(ICMP)': 'ICMP', 'Internet Group Management Protocol(IGMP)': 'IGMP', 'Simple Key-Management for Internet Protocol(SKIP)': 'SKIP', 'BBN RCC Monitoring(BBN-RCC-MON)': 'BBN-RCC-MON', 'Dissimilar Gateway Protocol(DGP)': 'DGP', 'No Next Header for IPv6(IPv6-NoNxt)': 'IPv6-NoNxt', 'Inter-Domain Policy Routing Protocol(IDPR)': 'IDPR', 'International Organization for Standardization Internet Protocol(ISO-IP)': 'ISO-IP', 'Interactive Agent Transfer Protocol(IATP)': 'IATP', 'PGM Reliable Transport Protocol(PGM)': 'PGM', 'Site Multihoming by IPv6 Intermediation(Shim6)': 'Shim6', 'Integrated Net Layer Security Protocol(I-NLSP)': 'I-NLSP', 'IL Transport Protocol(IL)': 'IL', 'Performance Transparency Protocol(PTP)': 'PTP', 'Wrapped Encapsulating Security Payload(WESP)': 'WESP', 'Packet Radio Measurement(PRM)': 'PRM', 'Packet Video Protocol(PVP)': 'PVP', 'Transport Layer Security Protocol (using Kryptonet key management)(TLSP)': 'TLSP', 'Kryptolan(KRYPTOLAN)': 'KRYPTOLAN', 'Secure Packet Shield(SPS)': 'SPS', 'Intermediate System to Intermediate System (IS-IS) Protocol over IPv4(IS-IS over IPv4)': 'IS-IS over IPv4', 'IPv6 Encapsulation(IPv6)': 'IPv6', 'Reservation Protocol (RSVP) End-to-End Ignore(RSVP-E2E-IGNORE)': 'RSVP-E2E-IGNORE', 'WIDEBAND Monitoring(WB-MON)': 'WB-MON', 'IP-within-IP Encapsulation Protocol(IPIP)': 'IPIP', 'IPv6 Hop-by-Hop Option(HOPOPT)': 'HOPOPT', 'Internet Stream Protocol(ST)': 'ST', 'SUN ND PROTOCOL-Temporary(SUN-ND)': 'SUN-ND', 'Combat Radio User Datagram(CRUDP)': 'CRUDP', 'Bulk Data Transfer Protocol(NETBLT)': 'NETBLT', 'MFE Network Services Protocol(MFE-NSP)': 'MFE-NSP', 'SATNET Monitoring(SAT-MON)': 'SAT-MON', 'Fragment Header for IPv6(IPv6-Frag)': 'IPv6-Frag', 'Universal Transport Interface Protocol(UTI)': 'UTI', 'Combat Radio Transport Protocol(CRTP)': 'CRTP', "IBM's ARIS (Aggregate Route IP Switching) Protocol(ARIS)": 'ARIS', 'D-II Data Exchange (DDX)(DDX)': 'DDX', 'Mobility Extension Header for IPv6(Mobility Header)': 'Mobility Header', 'Robust Header Compression(ROHC)': 'ROHC', 'Schedule Transfer Protocol(STP)': 'STP', 'MANET Protocols(manet)': 'manet', 'Destination Options for IPv6(IPv6-Opts)': 'IPv6-Opts', 'Source Demand Routing Protocol(SDRP)': 'SDRP', 'Host Monitoring Protocol(HMP)': 'HMP', 'Fibre Channel(FC)': 'FC', 'Mobile Internetworking Control Protocol(MICP)': 'MICP', 'Reliable Datagram Protocol(RDP)': 'RDP', 'Stream Control Transmission Protocol(SCTP)': 'SCTP', 'Leaf-2(LEAF-2)': 'LEAF-2', 'Private IP Encapsulation within IP(PIPE)': 'PIPE', 'Encapsulation Header(ENCAP)': 'ENCAP', 'Internet Protocol Traffic Manager(IPTM)': 'IPTM', 'Internet Reliable Transaction Protocol(IRTP)': 'IRTP', 'IP-Within-IP (encapsulation)(IP-in-IP)': 'IP-in-IP', 'XEROX NS IDP(XNS-IDP)': 'XNS-IDP', 'SCPS (Space Communications Protocol Standards)(SCPS)': 'SCPS', 'Mobile Host Routing Protocol(MHRP)': 'MHRP', 'IPX in IP(IPX-in-IP)': 'IPX-in-IP', 'Active Networks(A/N)': 'A/N', 'Backroom SATNET Monitoring(BR-SAT-MON)': 'BR-SAT-MON', 'Core-based trees(CBT)': 'CBT', 'Interior Gateway Protocol (any private interior gateway (used by Cisco for their IGRP))(IGP)': 'IGP', 'MERIT Internodal Protocol(MERIT-INP)': 'MERIT-INP', 'Host Identity Protocol(HIP)': 'HIP', 'Open Shortest Path First(OSPF)': 'OSPF', 'MIT Remote Virtual Disk Protocol(RVD)': 'RVD', 'Simple Multicast Protocol(SM)': 'SM', 'Leaf-1(LEAF-1)': 'LEAF-1', 'VISA Protocol(VISA)': 'VISA', 'User Datagram Protocol(UDP)': 'UDP', 'Wang Span Network(WSN)': 'WSN', 'Protocol Independent Multicast(PIM)': 'PIM', 'TP++ Transport Protocol(TP++)': 'TP++', 'Datagram Congestion Control Protocol(DCCP)': 'DCCP', 'ICMP for IPv6(IPv6-ICMP)': 'IPv6-ICMP', 'Encapsulating Security Payload(ESP)': 'ESP', 'Network Voice Protocol(NVP-II)': 'NVP-II', 'Sprite RPC Protocol(Sprite-RPC)': 'Sprite-RPC', 'Cross Net Debugger(XNET)': 'XNET', 'Xpress Transport Protocol(XTP)': 'XTP', 'ISO Transport Protocol Class 4(ISO-TP4)': 'ISO-TP4', 'Transmission Control Protocol(TCP)': 'TCP', 'Ipsilon Flow Management Protocol(IFMP)': 'IFMP', 'Compaq Peer Protocol(Compaq-Peer)': 'Compaq-Peer', 'SwIPe(SWIPE)': 'SWIPE', 'Secure Versatile Message Transaction Protocol(SECURE-VMTP)': 'SECURE-VMTP', 'Flexible Intra-AS Routing Environment(FIRE)': 'FIRE', 'Authentication Header(AH)': 'AH', 'Exterior Gateway Protocol(EGP)': 'EGP', 'Simple Message Protocol(SMP)': 'SMP', 'Sitara Networks Protocol(SNP)': 'SNP', 'IP Payload Compression Protocol(IPComp)': 'IPComp', 'NBMA Address Resolution Protocol(NARP)': 'NARP', 'Service-Specific Connection-Oriented Protocol in a Multilink and Connectionless Environment(SSCOPMCE)': 'SSCOPMCE', 'Routing Header for IPv6(IPv6-Route)': 'IPv6-Route', 'Computer Protocol Heart Beat(CPHB)': 'CPHB', 'Generic Routing Encapsulation(GRE)': 'GRE', 'Internet Pluribus Packet Core(IPPC)': 'IPPC', 'Trunk-2(TRUNK-2)': 'TRUNK-2', 'Layer Two Tunneling Protocol Version 3(L2TP)': 'L2TP', 'IP Mobility (Min Encap)(MOBILE)': 'MOBILE', 'Trunk-1(TRUNK-1)': 'TRUNK-1', 'SATNET and Backroom EXPAK(SAT-EXPAK)': 'SAT-EXPAK', 'Lightweight User Datagram Protocol(UDPLite)': 'UDPLite', 'IDPR Control Message Transport Protocol(IDPR-CMTP)': 'IDPR-CMTP', 'Inter-Domain Routing Protocol(IDRP)': 'IDRP', 'Multiprotocol Label Switching Encapsulated in IP(MPLS-in-IP)': 'MPLS-in-IP', 'Locus Address Resolution Protocol(LARP)': 'LARP', 'PNNI over IP(PNNI)': 'PNNI', 'Third Party Connect Protocol(3PC)': '3PC', 'Ethernet-within-IP Encapsulation(ETHERIP)': 'ETHERIP', 'Versatile Message Transaction Protocol(VMTP)': 'VMTP', 'Internet Packet Core Utility(IPCU)': 'IPCU'}
